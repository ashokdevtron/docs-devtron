"use strict";(self.webpackChunkdocdevtron=self.webpackChunkdocdevtron||[]).push([[4782],{8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>d});var t=r(6540);const s={},i=t.createContext(s);function o(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(i.Provider,{value:n},e.children)}},8647:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>u,frontMatter:()=>o,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"setup/install/prod-infra","title":"Production Infra Recommendations","description":"1. Infrastructure Overview","source":"@site/docs/setup/install/prod-infra.md","sourceDirName":"setup/install","slug":"/setup/install/prod-infra","permalink":"/docs/setup/install/prod-infra","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"FAQ","permalink":"/docs/setup/install/faq-on-installation"},"next":{"title":"Configurations","permalink":"/docs/setup/configurations/configurations-overview"}}');var s=r(4848),i=r(8453);const o={},d="Production Infra Recommendations",l={},c=[{value:"1. Infrastructure Overview",id:"1-infrastructure-overview",level:2},{value:"Node Group Structure",id:"node-group-structure",level:3},{value:"Autoscaling Configuration",id:"autoscaling-configuration",level:3},{value:"Blob Storage",id:"blob-storage",level:3},{value:"2. Cloud-Specific Setup Guidelines",id:"2-cloud-specific-setup-guidelines",level:2},{value:"AWS (EKS)",id:"aws-eks",level:3},{value:"GCP (GKE)",id:"gcp-gke",level:3},{value:"Azure (AKS)",id:"azure-aks",level:3},{value:"3. Microservice Resource Recommendations",id:"3-microservice-resource-recommendations",level:2},{value:"Need a YAML template to add resources?",id:"need-a-yaml-template-to-add-resources",level:3},{value:"4. Kubernetes Configuration",id:"4-kubernetes-configuration",level:2},{value:"CI Isolation with Taints and Tolerations",id:"ci-isolation-with-taints-and-tolerations",level:3}];function a(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"production-infra-recommendations",children:"Production Infra Recommendations"})}),"\n",(0,s.jsx)(n.h2,{id:"1-infrastructure-overview",children:"1. Infrastructure Overview"}),"\n",(0,s.jsx)(n.p,{children:"For production environments, we recommend a dedicated infrastructure setup that separates Devtron microservices to ensure optimal performance, reliability, and cost efficiency."}),"\n",(0,s.jsx)(n.h3,{id:"node-group-structure",children:"Node Group Structure"}),"\n",(0,s.jsx)(n.p,{children:"Set up separate node groups to isolate workloads, optimize resource allocation, and ensure system stability under production load."}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Node Group"}),(0,s.jsx)(n.th,{children:"Purpose"}),(0,s.jsx)(n.th,{children:"Instance Type"}),(0,s.jsx)(n.th,{children:"Configuration"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Devtron Microservices"})}),(0,s.jsx)(n.td,{children:"Hosts all Devtron core components"}),(0,s.jsx)(n.td,{children:"On-Demand"}),(0,s.jsx)(n.td,{children:"3 nodes (4 CPU, 16 GB RAM each)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"CI Workers"})}),(0,s.jsx)(n.td,{children:"Handles build jobs and CI processes"}),(0,s.jsx)(n.td,{children:"Spot Instances"}),(0,s.jsx)(n.td,{children:"Auto-scaling based on workload"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"autoscaling-configuration",children:"Autoscaling Configuration"}),"\n",(0,s.jsx)(n.p,{children:"Configure autoscaling to handle fluctuating workloads efficiently, reduce downtime, and control cloud costs without manual intervention."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Devtron Node Group"}),": Minimum 1 node, Maximum 5 nodes (Autoscaled)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"CI Node Group"})," (Tainted): Configure based on build volume and concurrency requirements"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"blob-storage",children:"Blob Storage"}),"\n",(0,s.jsxs)(n.p,{children:["Use blob storage to persist build caches and logs, enabling faster builds and reliable CI troubleshooting in production environments. Refer ",(0,s.jsx)(n.a,{href:"./installation-configuration#configuration-of-blob-storage",children:"Blob Storage Guide"})," to know more."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Cache-Storage"}),": Used to store the build cache to reduce build time of your application."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"CI Logs Bucket"}),": Used to store the build logs of your application."]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"2-cloud-specific-setup-guidelines",children:"2. Cloud-Specific Setup Guidelines"}),"\n",(0,s.jsx)(n.p,{children:"Depending on your choice of cloud provider, refer the instructions/scripts below to set up a cluster."}),"\n",(0,s.jsx)(n.h3,{id:"aws-eks",children:"AWS (EKS)"}),"\n",(0,s.jsxs)(n.p,{children:["You can follow this ",(0,s.jsx)(n.a,{href:"https://github.com/devtron-labs/utilities/tree/main/eksctl-configs#creating-a-cluster-for-devtron-setup",children:"Readme"})," for setting up the EKS cluster for Devtron."]}),"\n",(0,s.jsx)(n.h3,{id:"gcp-gke",children:"GCP (GKE)"}),"\n",(0,s.jsxs)(n.p,{children:["Use our provided ",(0,s.jsx)(n.a,{href:"https://github.com/devtron-labs/utilities/tree/main/terraform/terraform-gke",children:"Terraform scripts"})," to set up GKE cluster for Devtron."]}),"\n",(0,s.jsx)(n.h3,{id:"azure-aks",children:"Azure (AKS)"}),"\n",(0,s.jsxs)(n.p,{children:["Use our provided ",(0,s.jsx)(n.a,{href:"https://github.com/devtron-labs/utilities/tree/main/terraform/terraform-aks",children:"Terraform scripts"})," to set up AKS cluster for Devtron."]}),"\n",(0,s.jsx)(n.admonition,{title:"Next Step",type:"tip",children:(0,s.jsxs)(n.p,{children:["Proceed with the ",(0,s.jsx)(n.a,{href:"/docs/setup/install/install-devtron",children:"Devtron installation on your cluster"}),"."]})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"3-microservice-resource-recommendations",children:"3. Microservice Resource Recommendations"}),"\n",(0,s.jsx)(n.p,{children:"Below are the core components (Devtron microservices) for which you need to allocate appropriate CPU and memory resources. This will ensure optimum performance and prevent resource contention in production."}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Component"}),(0,s.jsx)(n.th,{children:"CPU Requests"}),(0,s.jsx)(n.th,{children:"CPU Limits"}),(0,s.jsx)(n.th,{children:"Memory Requests"}),(0,s.jsx)(n.th,{children:"Memory Limits"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Devtron"})}),(0,s.jsx)(n.td,{children:"1"}),(0,s.jsx)(n.td,{children:"1"}),(0,s.jsx)(n.td,{children:"1536Mi"}),(0,s.jsx)(n.td,{children:"1536Mi"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Kubelink"})}),(0,s.jsx)(n.td,{children:"1"}),(0,s.jsx)(n.td,{children:"1"}),(0,s.jsx)(n.td,{children:"1536Mi"}),(0,s.jsx)(n.td,{children:"1536Mi"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Dashboard"})}),(0,s.jsx)(n.td,{children:"100m"}),(0,s.jsx)(n.td,{children:"100m"}),(0,s.jsx)(n.td,{children:"150Mi"}),(0,s.jsx)(n.td,{children:"150Mi"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Lens"})}),(0,s.jsx)(n.td,{children:"200m"}),(0,s.jsx)(n.td,{children:"200m"}),(0,s.jsx)(n.td,{children:"100Mi"}),(0,s.jsx)(n.td,{children:"100Mi"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Git-sensor"})}),(0,s.jsx)(n.td,{children:"800m"}),(0,s.jsx)(n.td,{children:"1"}),(0,s.jsx)(n.td,{children:"1510Mi"}),(0,s.jsx)(n.td,{children:"1510Mi"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Kubewatch"})}),(0,s.jsx)(n.td,{children:"200m"}),(0,s.jsx)(n.td,{children:"300m"}),(0,s.jsx)(n.td,{children:"600Mi"}),(0,s.jsx)(n.td,{children:"1000Mi"})]})]})]}),"\n",(0,s.jsxs)(n.admonition,{type:"info",children:[(0,s.jsx)(n.h3,{id:"need-a-yaml-template-to-add-resources",children:"Need a YAML template to add resources?"}),(0,s.jsxs)(n.p,{children:["You can create a resources file similar to this ",(0,s.jsx)(n.a,{href:"https://github.com/devtron-labs/devtron/blob/main/charts/devtron/resources-small.yaml",children:"YAML file"})," and add resources according to your load and requirements for any service you want, and remove those you don\u2019t wish to modify."]}),(0,s.jsx)(n.p,{children:"Run the following command once the file is ready:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"helm upgrade devtron devtron/devtron-operator -n devtroncd --reuse-values -f resources-values-file.yaml\n"})})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"4-kubernetes-configuration",children:"4. Kubernetes Configuration"}),"\n",(0,s.jsx)(n.h3,{id:"ci-isolation-with-taints-and-tolerations",children:"CI Isolation with Taints and Tolerations"}),"\n",(0,s.jsxs)(n.p,{children:["To ensure CI workloads run exclusively on the dedicated CI nodes, you need to specify the taints and labels to the node. Then, for the CI build pods, you can add the tolerations and node selectors in the ",(0,s.jsx)(n.code,{children:"devtron-custom-cm"})," (ConfigMap) of ",(0,s.jsx)(n.code,{children:"devtroncd"})," namespace using ",(0,s.jsx)(n.a,{href:"./installation-configuration#configure-overrides",children:"these keys"}),". These will automatically propagate to CI workloads when they are created."]}),"\n",(0,s.jsxs)(n.p,{children:["If you are following our ",(0,s.jsx)(n.a,{href:"#2-cloud-specific-setup-guidelines",children:"Cloud-Specific Setup Guidelines"})," then set the below values for the keys in ",(0,s.jsx)(n.code,{children:"devtron-custom-cm"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"CI_NODE_LABEL_SELECTOR: purpose=ci\nCI_NODE_TAINTS_KEY: dedicated\nCI_NODE_TAINTS_VALUE: ci\n"})})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}}}]);